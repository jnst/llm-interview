---
title: ビーム探索
contexts:
  - ai
---

## ビーム探索

<Context name="ai">

### 概要と基本原理
ビーム探索は、シーケンシャルなテキスト生成で、より高品質な出力を得るための探索アルゴリズムです。一度に一つのトークンを選ぶのではなく、複数の有力な候補シーケンスを並行して維持し、最終的に最も全体的なスコアが高いシーケンスを選択します。これは、複数のルートを同時に考慮して最適な経路を選ぶナビゲーションシステムに似ており、局所的な最適化ではなく大域的な品質向上を実現します。

### 技術的特徴
ビーム探索の核心は、ビーム幅（beam width）と呼ばれるハイパーパラメータで、維持する候補数を制御します。各ステップで、各候補から次のトークンを生成し、その確率を累積してスコアを計算します。その後、上位のビーム幅個の候補のみを次のステップに進め、このプロセスを終了条件まで繰り返します。ビーム幅が大きいほど品質は向上しますが、計算コストも増大します。

### 応用可能性
ビーム探索は、機械翻訳、文書要約、チャットボット、コード生成など、高品質なテキストが求められる場面で幅広く使用されています。特に、商用サービスやプロダクション環境では、少しの計算コストをかけてでも品質を向上させたい場面で重宝されます。また、复数の候補を生成してユーザーに選択させるインタラクティブなシステムでも活用されています。

### 他の技術との関連
ビーム探索は、グリーディ探索、ランダムサンプリング、Top-kサンプリングなどの他のデコーディング手法と対比され、品質と多様性のトレードオフの中で位置づけられます。また、テンプレートラーチャーやペナルティ項目と組み合わせて使用され、繰り返しや長さバイアスなどの問題を解決します。音声認識や画像キャプションなど、シーケンシャルな出力が必要な他の分野でも使用されます。

### なぜ重要なのか
ビーム探索が重要な理由は、「局所最適の罠」を回避して大域的な品質向上を実現することです。グリーディな選択では、各ステップで最適に見える選択が、最終的には低品質な出力に繋がる可能性があります。ビーム探索は、複数の候補を維持することで、より長期的な視点での最適化を可能にし、実用的なAIシステムの品質を支える重要な技術です。

</Context>
