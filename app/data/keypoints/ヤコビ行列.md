---
title: ヤコビ行列
contexts:
  - math
---

<Context name="math">

## ヤコビ行列

ヤコビ行列（Jacobian Matrix）は、多変数ベクトル値関数の1階偏導数を行列形式で表現したものです。多変数関数の局所的な変化率を包括的に捉え、機械学習の最適化において勾配計算の基盤となる重要な数学概念です。

### 基本的な定義

ヤコビ行列の核心は**多変数関数の線形近似**にあります：

n変数m値関数 f: ℝⁿ → ℝᵐ に対して、ヤコビ行列 J は：

```
J = [∂f₁/∂x₁  ∂f₁/∂x₂  ...  ∂f₁/∂xₙ]
    [∂f₂/∂x₁  ∂f₂/∂x₂  ...  ∂f₂/∂xₙ]
    [   ⋮         ⋮       ⋱     ⋮    ]
    [∂fᵐ/∂x₁  ∂fᵐ/∂x₂  ...  ∂fᵐ/∂xₙ]
```

各要素 J_{ij} = ∂f_i/∂x_j は、j番目の入力変数に対するi番目の出力の偏導数です。

### なぜヤコビ行列が重要なのか

**多変数関数の局所的挙動の把握**：
- 複雑な非線形関数の線形近似
- 各変数の変化が出力に与える影響を定量化
- 関数の感度分析が可能

**最適化問題の基盤**：
- 勾配降下法における方向決定
- ニュートン法等の高次最適化手法
- 制約付き最適化問題の解法

**変数間の相互作用の分析**：
- 入力変数間の独立性・依存性
- 関数の可逆性（ヤコビ行列式）
- 座標変換の理論的基盤

### 機械学習での応用

**勾配降下法**：
- 損失関数の勾配計算
- パラメータ更新の方向決定
- 学習率の調整

**バックプロパゲーション**：
- 合成関数の連鎖律適用
- 各層の勾配計算
- 効率的な勾配伝播

**ニューラルネットワークの解析**：
- 活性化関数の影響評価
- 勾配消失・爆発の診断
- ネットワークの安定性解析

### 具体的な計算例

**2変数2値関数の場合**：
```
f(x,y) = [x² + y²]
         [xy    ]

J = [2x  2y]
    [y   x ]
```

**ReLU活性化関数**：
```
f(x) = max(0, x)
J = {1  if x > 0
    {0  if x < 0
    {undefined  if x = 0
```

### 特殊な性質

**ヤコビ行列式（Jacobian Determinant）**：
- 正方行列（n×n）の場合の行列式
- 座標変換の体積比
- 関数の局所的な可逆性の指標

**条件数（Condition Number）**：
- 行列の数値的安定性
- 最適化の収束性に影響
- 病的問題の検出

**ランク（Rank）**：
- 線形独立な行・列の数
- 関数の自由度
- 制約の有効性

### 他の数学概念との関連

**勾配ベクトルとの関係**：
- スカラー値関数（m=1）のヤコビ行列は勾配ベクトルの転置
- ∇f = J^T（1×n行列）
- 方向微分の計算に利用

**ヘッセ行列との関係**：
- ヤコビ行列の各行のヤコビ行列がヘッセ行列
- 2階微分情報を含む
- 最適化の高次手法で使用

**テイラー展開との関係**：
- 多変数関数の1次近似
- f(x₀ + h) ≈ f(x₀) + J(x₀)h
- 局所的な線形近似の基盤

### 実用的な計算手法

**数値微分**：
- 有限差分法による近似
- 実装は簡単だが精度に制約
- 計算コストが高い

**自動微分**：
- 計算グラフを利用した正確な計算
- 前進モード・後退モード
- 現代的な深層学習フレームワークで標準

**シンボリック微分**：
- 解析的な導出
- 高精度だが複雑な関数では困難
- 数式処理システムで実装

### 最適化への応用

**ニュートン法**：
- J(x)Δx = -f(x)
- 2階収束の高速最適化
- ヤコビ行列の逆行列が必要

**準ニュートン法**：
- ヤコビ行列の近似更新
- BFGS、L-BFGS等の手法
- 計算効率と収束性のバランス

**制約最適化**：
- 制約条件のヤコビ行列
- KKT条件の定式化
- ラグランジュ乗数法

### 数値的な考慮事項

**条件数の問題**：
- 病的なヤコビ行列の処理
- 正則化による改善
- 特異値分解の利用

**計算効率**：
- スパース行列の活用
- 自動微分の最適化
- 並列計算の適用

**精度の確保**：
- 丸め誤差の制御
- 数値安定性の確保
- 適切な数値解法の選択

ヤコビ行列は、多変数解析の基本概念でありながら、現代の機械学習・最適化技術の理論的基盤として不可欠な役割を果たしています。複雑な非線形関数の挙動を理解し、効率的な最適化を可能にする重要な数学的道具です。

</Context>

