---
title: 内積
contexts:
  - ai
---

<Context name="ai">

## 内積

内積は、2つのベクトルの「方向の類似性」と「大きさの積」を測る数学的操作です。AIの世界では、データの類似性を測る最も基本的な道具として機能します。

### 本質的な理解

内積 a·b = |a||b|cos(θ) という公式の背後にある意味を理解することが重要です。これは単なる計算式ではなく、「2つのベクトルがどれだけ同じ方向を向いているか」を表しています。cosθの値により、完全に同じ方向（θ=0°、cos=1）から垂直（θ=90°、cos=0）、完全に反対方向（θ=180°、cos=-1）までの関係性が数値化されます。

### AIにおける応用の原理

**類似性の測定**: 単語や文書をベクトルで表現した際、内積の値が大きいほど意味的に類似していることを示します。これは、類似した概念は高次元空間で近い方向を向く傾向があるためです。

**推薦システム**: ユーザーの好みベクトルと商品の特徴ベクトルの内積により、そのユーザーがその商品を好む可能性を予測できます。

**注意機構（Attention）**: Transformerにおいて、クエリとキーの内積により、どの情報に注目すべきかを決定します。

### 他の概念との関連

- **コサイン類似度**: 内積を正規化した概念で、ベクトルの大きさの影響を除いた純粋な方向の類似性を測定
- **線形変換**: 行列とベクトルの積も内積の一般化として理解できる
- **射影**: ベクトルの内積は、一方のベクトルを他方に射影した長さと関連

### なぜ内積が重要なのか

内積が重要な理由は、高次元空間において「距離」よりも「方向性」が重要だからです。例えば、文書の長さは異なっても、同じトピックについて書かれていれば類似しているとみなすべきです。内積（特にコサイン類似度）は、この直感的な類似性を数学的に表現する手段を提供します。

</Context>
