---
title: 連鎖律
contexts:
  - optimization-algorithms
---

<Context name="optimization-algorithms">

## 連鎖律

連鎖律（Chain Rule）は、合成関数の微分を計算するための微分法の基本原理です。機械学習、特に深層学習の最適化アルゴリズムにおいて、複雑なネットワーク構造での勾配計算を可能にする根本的な数学的基盤となります。

### 基本的な定義と仕組み

連鎖律の基本形は以下の通りです：

合成関数 z = f(g(x)) において、dz/dx = (dz/df) × (df/dx)

これを一般化すると：
- z = f(u), u = g(x) の場合
- dz/dx = (dz/du) × (du/dx)

### なぜ連鎖律が重要なのか

**1. 複雑な関数の微分が可能**
- 単純な関数の組み合わせで複雑な関数を表現
- 各部分の微分を計算して全体の微分を求める

**2. 計算の効率化**
- 中間結果を再利用することで計算量を削減
- メモリ効率の向上

**3. 自動微分の基盤**
- 現代の深層学習フレームワークの核心技術
- 計算グラフを構築して自動的に勾配を計算

### 最適化アルゴリズムでの応用

**逆伝播アルゴリズム**
```
Loss = L(f₃(f₂(f₁(x))))
∂L/∂w₁ = (∂L/∂f₃) × (∂f₃/∂f₂) × (∂f₂/∂f₁) × (∂f₁/∂w₁)
```

**勾配降下法との関係**
- 連鎖律により各層の重みに対する勾配を効率的に計算
- パラメータ更新の方向を決定

### 他の数学概念との関連

**偏微分との関係**
- 多変数関数では偏微分と組み合わせて使用
- ∂z/∂x = Σᵢ (∂z/∂uᵢ) × (∂uᵢ/∂x)

**ヤコビ行列との関係**
- ベクトル値関数の微分では、ヤコビ行列の積として表現
- 高次元データでの効率的な計算が可能

### 実装上の考慮点

**数値的安定性**
- 勾配消失：連鎖的な乗算により勾配が非常に小さくなる
- 勾配爆発：勾配が異常に大きくなる問題

**計算順序の最適化**
- 前向きモード vs 後向きモード自動微分
- 計算グラフの構築とメモリ管理

**精度の維持**
- 浮動小数点演算の累積誤差
- 数値微分との比較による検証

連鎖律は単純な数学的概念でありながら、現代の機械学習システムの根幹を支える重要な原理です。その理解は、最適化アルゴリズムの動作原理を深く理解するための必須知識となります。

</Context>

